############################################################
# Pure Prompt – FULL CUSTOM CONFIG (Latest Pure Compatible)
############################################################

###############
# Pure Options
###############
PURE_PROMPT_SYMBOL="❯"
PURE_PROMPT_VICMD_SYMBOL="❮"
PURE_CMD_MAX_EXEC_TIME=5
PURE_GIT_UP_ARROW="⇡"
PURE_GIT_DOWN_ARROW="⇣"
PURE_GIT_UNTRACKED_DIRTY=1

########################
# Load & Initialize Pure
########################
fpath+=(~/.config/zsh/plugins/pure)
autoload -U promptinit; promptinit
prompt pure

############################################################
# ALWAYS SHOW user@host
############################################################
typeset -gA prompt_pure_state
prompt_pure_state[username]="%F{magenta}%n%f@%F{cyan}%m%f"
if (( $+functions[prompt_pure_setup] )); then
    prompt_pure_setup
    prompt_pure_state[username]="%F{magenta}%n%f@%F{cyan}%m%f"
fi
if (( $+functions[prompt_pure_preprompt_render] )); then
    prompt_pure_preprompt_render "precmd"
fi

############################################################
# REMOVE EMPTY LINE BETWEEN PROMPTS
############################################################
print() {
  [[ $# -eq 0 && ${funcstack[-1]} = prompt_pure_precmd ]] \
    || builtin print "$@"
}

############################################################
# GIT COLOR CUSTOMIZATION (via zstyle)
############################################################
zstyle :prompt:pure:git:stash show yes
zstyle ':prompt:pure:git:branch'        color 'bright-blue'
zstyle ':prompt:pure:git:branch:cached' color 'yellow'
zstyle ':prompt:pure:git:dirty'         color 'red'
zstyle ':prompt:pure:git:arrow'         color 'cyan'
zstyle ':prompt:pure:git:stash'         color 'magenta'

############################################################
# PREPEND BRANCH ICON SAFELY
############################################################
precmd() {
    if [[ -n ${prompt_pure_state[current_branch]} ]]; then
        # Avoid multiple prepends
        prompt_pure_state[current_branch]=" ${prompt_pure_state[current_branch]# }"
    fi
}

